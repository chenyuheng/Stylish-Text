<html>
	<head>
		<title>风格文本 / Stylish Text</title>
		<meta charset="UTF-8">
		<script type="text/javascript">
            let patterns = [];

			function Pattern(name){
				this.name = name;
				this.dict = [];
			}

			Pattern.prototype.translate = function(origin) {
				let i;
				let newText = "";
				for(i = 0; i < origin.length; i++) {
					if (this.dict[origin.charAt(i)] !== undefined) {
						newText+=this.dict[origin.charAt(i)];
					} else {
						newText += origin.charAt(i);
					}
				}
				return newText;
			}

			function getJson(url) {
				const httpReq = new XMLHttpRequest();
				httpReq.open("GET", url, false);
				httpReq.send(null);
				const jsonObj = JSON.parse(httpReq.responseText);
				return jsonObj;
			}

			function run() {
				const originText = document.getElementById("originText").value;
				let i;
				let outputString = "";
				for (i = 0; i < patterns.length; i++) {
					let translatedText = patterns[i].translate(originText);
					outputString += translatedText + "<br />";
				}
                const outputBox = document.getElementById("output")
                outputBox.innerHTML = outputString;
			}

			function load() {
                const url = "styles.json";
                const jsonObj = getJson(url);
                let i;
                for (i = 0; i < jsonObj.length; i++) {
                    let tempPattern = new Pattern(jsonObj[i]["name"]);
                    tempPattern.dict = jsonObj[i];
                    patterns.push(tempPattern);
                }
                run();
            }

		</script>
	</head>
	
	<body onload="load()">
		<p>
			原文 / Original Text:<br />
			<textarea rows="10" cols="50" id="originText">Good good study, day day up!</textarea>
		</p>
		<button type="button" onclick="run()">提交 / Submit</button>
		<p>
			转换后 / Transformed Text:<br />
			<div id="output"></div>
		</p>
	</body>
</html>